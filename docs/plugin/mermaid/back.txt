sequenceDiagram
Note right of Merchant Front: The customer clicks<br>on the Pledg button
Merchant Front->> Pledg Plugin: Javascript call
Note right of Pledg Plugin: The Pledg Plugin opens<br>inside the Merchant Front<br>an iframe containing<br>the Pledg Front
Pledg Plugin->> Pledg Front: HTTP GET
Note right of Pledg Front: The customer validates<br>the terms of the<br>payment facility
Note right of Pledg Front: The customer sets<br>the cards details
Pledg Front->> Pledg PSP: Customer card details
Pledg PSP->> Pledg Front: Token
Pledg Front->> Pledg Back: Token
Note right of Pledg Back: The token is registered<br>for future use
Pledg Back->> Pledg PSP: Charge request
Pledg PSP->> Pledg Back: OK
Pledg Back->> Pledg Virtual card provider: Virtual card request
Pledg Virtual card provider->> Pledg Back: Virtual card details
Pledg Back->> Merchant PSP: Charge request
Merchant PSP->>Pledg Back: Transaction result
Pledg Back->> Pledg Front: Transaction result
Merchant PSP->>Merchant Back: Notification
Pledg Front->> Pledg Plugin: Transaction result
Pledg Plugin->> Merchant Front: Transaction result
Merchant Front->> Merchant Back: Transaction result
